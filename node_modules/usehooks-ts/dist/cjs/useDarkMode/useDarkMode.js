"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useDarkMode = void 0;
var useLocalStorage_1 = require("../useLocalStorage");
var useMediaQuery_1 = require("../useMediaQuery");
var useUpdateEffect_1 = require("../useUpdateEffect");
var COLOR_SCHEME_QUERY = '(prefers-color-scheme: dark)';
var LOCAL_STORAGE_KEY = 'usehooks-ts-dark-mode';
function useDarkMode(defaultValue, localStorageKey) {
    var _a;
    if (localStorageKey === void 0) { localStorageKey = LOCAL_STORAGE_KEY; }
    var isDarkOS = (0, useMediaQuery_1.useMediaQuery)(COLOR_SCHEME_QUERY);
    var _b = (0, useLocalStorage_1.useLocalStorage)(localStorageKey, (_a = defaultValue !== null && defaultValue !== void 0 ? defaultValue : isDarkOS) !== null && _a !== void 0 ? _a : false), isDarkMode = _b[0], setDarkMode = _b[1];
    (0, useUpdateEffect_1.useUpdateEffect)(function () {
        setDarkMode(isDarkOS);
    }, [isDarkOS]);
    return {
        isDarkMode: isDarkMode,
        toggle: function () { return setDarkMode(function (prev) { return !prev; }); },
        enable: function () { return setDarkMode(true); },
        disable: function () { return setDarkMode(false); },
        set: function (value) { return setDarkMode(value); },
    };
}
exports.useDarkMode = useDarkMode;
